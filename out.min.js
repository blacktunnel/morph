!function(Settings,window,document,undefined){var TILESIZE=Settings.tileSize,VIEWPORT_SHIFT_BOUNDARY=Settings.viewportShiftBoundary,MENU_WIDTH=Settings.menuWidth,MENU_HEIGHT=Settings.menuHeight,MENU_LINE_WIDTH=Settings.menuLineWidth,LEFT_KEY=Settings.leftKey,RIGHT_KEY=Settings.rightKey,DOWN_KEY=Settings.downKey,UP_KEY=Settings.upKey,ACTION_KEY=Settings.actionKey,JUMP_KEY=Settings.jumpKey,PAUSE_KEY=Settings.pauseKey,MAP_KEY=Settings.mapKey,INVENTORY_KEY=Settings.inventoryKey,ENTER_KEY=Settings.enterKey,GOD_MODE=Settings.godMode,LAND_BACKGROUND=Settings.landBackground,SEA_BACKGROUND=Settings.seaBackground,INIT_MAX_HEALTH=Settings.initialMaxHealth;LEVEL_NAME_COLOR=Settings.levelNameColor,LEVEL_NAME_FONT_SIZE=Settings.levelNameFontSize;var Game={toBeDestroyed:[],keysDown:{},imageCount:1,paused:false,init:function(t){Game.viewportWidth=Game.viewportTileWidth*TILESIZE;Game.viewportHeight=Game.viewportTileHeight*TILESIZE;Game.viewportOffset=0;Game.viewportShiftBoundary={left:Math.floor(Game.viewportTileWidth/2)*TILESIZE+VIEWPORT_SHIFT_BOUNDARY*TILESIZE,right:Math.floor(Game.viewportTileWidth/2)*TILESIZE-VIEWPORT_SHIFT_BOUNDARY*TILESIZE};var e=TILESIZE*MENU_WIDTH,i=TILESIZE*MENU_HEIGHT,n=MENU_LINE_WIDTH;Game.pauseMenu=new Game.Menu.Pause((Game.viewportWidth-e)/2,(Game.viewportHeight-i)/2,e,i,n);Game.gameOverMenu=new Game.Menu.GameOver((Game.viewportWidth-e)/2,(Game.viewportHeight-i)/2,e,i,n);Game.canvas=document.createElement("canvas");Game.canvas.width=Game.viewportWidth;Game.canvas.height=Game.viewportHeight;document.getElementById("game").appendChild(Game.canvas);Game.ctx=Game.canvas.getContext("2d");Game.initSprites();if(Game.clickStep){document.onclick=Game.nextGameFrame}Game.keysLocked=false;Game.initDrawLayers();Game.currentLevel=Game.Levels[t];Game.viewportShiftBuffer=Game.currentLevel.width-Game.viewportWidth;Game.loadLevel();var a=Game.currentLevel.scene;if(a){Game.currentLevel.scene=new Game.Scene(a.actors,a.actions)}if(Game.currentLevel.scene){Game.currentLevel.scene.play()}},initSprites:function(){Game.totalSprites=0;for(var t in Game.Bitmaps){Game.Sprites[t]=Game.Sprite(Game.convertBitmapToSprite(Game.Bitmaps[t],TILESIZE/9));Game.totalSprites++}},convertBitmapToSprite:function(t,e){var i,n,a,o;a=document.createElement("canvas");a.width=t[0].length*e;a.height=t.length*e;tempContext=a.getContext("2d");for(i in t){for(n in t[i]){tempContext.fillStyle=t[i][n];tempContext.fillRect(n*e,i*e,e,e)}}return a.toDataURL("image/png")},initDrawLayers:function(){Game.drawLayers=[[],[],[],[],[],[]]},startLoop:function(){addEventListener("keydown",Game.keyDownListener,false);addEventListener("keyup",Game.keyUpListener,false);Game.ctx.fillStyle=Game.background;Game.ctx.fillRect(0,0,Game.viewportWidth,Game.viewportHeight);Game.invalidateRect(0,0,Game.viewportWidth,Game.viewportHeight);for(var t in Game.currentLevel.entities){Game.currentLevel.entities[t].render()}Game.lastUpdate=null;Game.requestID=requestAnimationFrame(Game.loop)},loop:function(t){var e;if(Game.lastUpdate){if(!Game.clickStep){e=t-Game.lastUpdate}else{e=300}Game.update(e);Game.render(e)}Game.lastUpdate=t;if(!Game.clickStep){if(!Game.stopLoop&&!Game.paused){Game.requestID=requestAnimationFrame(Game.loop)}else if(Game.showSign){Game.showSignMenu()}else if(Game.switchToLevel){Game.performLevelSwitch()}}},update:function(t){if(Game.currentLevel.scene&&Game.currentLevel.scene.playing){var e=Game.currentLevel.scene;e.next()}if(Game.hero.pos.x>=Game.currentLevel.width-Game.hero.width&&Game.currentLevel.next){Game.currentLevel.loadNextLevel();return}var i=Game.currentLevel.entities;for(var n=Game.toBeDestroyed.length-1;n>=0;n--){drawLayer=Game.drawLayers[Game.toBeDestroyed[n].drawLayer];for(var a=i.length-1;a>=0;a--){if(i[a]==Game.toBeDestroyed[n]){i[a].invalidateRect();i.splice(a,1)}}for(var a=drawLayer.length-1;a>=0;a--){if(drawLayer[a]==Game.toBeDestroyed[n]){drawLayer.splice(a,1)}}Game.toBeDestroyed.splice(n,1)}for(var n=0;n<i.length;n++){i[n].generateNextCoords(t)}i.sort(function(t,e){return t.pos.x-e.pos.x});var o=new Array(i[0]);var r=new Array;for(var n=1;n<i.length;n++){for(var a=o.length-1;a>=0;a--){if(i[n].pos.x>o[a].pos.x+o[a].width){o.splice(a,1);continue}else if(i[n]!=o[a]){r.push([i[n],o[a]])}}o.push(i[n])}for(var n=0;n<r.length;n++){var s=r[n];if(s[0]instanceof Game.Entity&&s[1]instanceof Game.Entity){Game.collider(s[0],s[1])}}for(var n=0;n<i.length;n++){var l=i[n];if(Game.still){l.pos.x=l.oldPos.x;l.pos.y=l.oldPos.y}if(l.pos.x!=l.oldPos.x||l.pos.y!=l.oldPos.y||l.animated||l.detached||l.attached){l.invalidateRect()}}if(Game.currentLevel.type=="sky"){if(Game.viewportOffset<Game.viewportShiftBuffer){Game.lastShift=Date.now();Game.hero.pos.x+=TILESIZE/18;Game.viewportShiftBoundary.left=Game.hero.pos.x-TILESIZE/18;Game.shiftViewport("left")}}else{if(Game.hero.pos.x>Game.viewportShiftBoundary.left&&Game.viewportOffset<Game.viewportShiftBuffer){Game.shiftViewport("left")}else if(Game.hero.pos.x<Game.viewportShiftBoundary.right&&Game.viewportOffset){Game.shiftViewport("right")}}},shiftViewport:function(t){if(t=="left"){Game.viewportShiftLeft=Game.hero.pos.x-Game.viewportShiftBoundary.left;if(Game.viewportShiftLeft+Game.viewportOffset>Game.viewportShiftBuffer){Game.viewportShiftLeft=Game.viewportShiftBuffer-Game.viewportOffset}Game.viewportShiftBoundary.left+=Game.viewportShiftLeft;Game.viewportShiftBoundary.right+=Game.viewportShiftLeft;Game.viewportOffset+=Game.viewportShiftLeft;Game.lastAddedColumn=Game.lastAddedColumn||Game.viewportTileWidth-1;var e,i,n,a=Math.ceil(Game.viewportOffset/TILESIZE),o=Game.viewportTileWidth+a;for(e=Game.lastAddedColumn+1;e<=o;e++){for(i=0;i<Game.currentLevel.entityGrid.length;i++){n=Game.currentLevel.entityGrid[i][e];if(n){Game.currentLevel.entities.push(n)}}}Game.lastAddedColumn=o}else{Game.viewportShiftRight=Game.viewportShiftBoundary.right-Game.hero.pos.x;Game.viewportShiftBoundary.left-=Game.viewportShiftRight;Game.viewportShiftBoundary.right-=Game.viewportShiftRight;if(Game.viewportOffset-Game.viewportShiftRight>=0){Game.viewportOffset-=Game.viewportShiftRight}}},collider:function(t,e){var i=t.getCollisions(e),n=e.getCollisions(t);if(i){t.collideWith(e,i);e.collideWith(t,n)}else if(n){e.collideWith(t,n);t.collideWith(e,i)}},destroyEntity:function(t){Game.toBeDestroyed.push(t)},invalidateRect:function(t,e,i,n){if(!Game.invalidRect){Game.invalidRect={top:t,right:e,bottom:i,left:n};return}var a=Game.invalidRect.top,o=Game.invalidRect.bottom,r=Game.invalidRect.left,s=Game.invalidRect.right;if(a>t){Game.invalidRect.top=t}if(o<i){Game.invalidRect.bottom=i}if(r>n){Game.invalidRect.left=n}if(s<e){Game.invalidRect.right=e}},render:function(){var t,e,i,n,a,o,r;if(Game.invalidRect){n=Game.invalidRect.left-Game.viewportOffset;a=Game.invalidRect.top;o=Game.invalidRect.right-Game.viewportOffset-n;r=Game.invalidRect.bottom-a;if(Game.viewportShiftLeft){var s=0,l=Game.viewportShiftLeft,h=Game.viewportWidth-l,c=Game.viewportHeight;i=Game.ctx.getImageData(l,s,h,c);Game.ctx.putImageData(i,0,0);Game.ctx.clearRect(h,s,l,c);a=0;n=0;o=Game.viewportWidth;r=Game.viewportHeight;Game.viewportShiftLeft=false}else if(Game.viewportShiftRight){var s=0,l=0,h=Game.viewportWidth-Game.viewportShiftRight,c=Game.viewportHeight;i=Game.ctx.getImageData(l,s,h,c);Game.ctx.putImageData(i,Game.viewportShiftRight,0);Game.ctx.clearRect(0,0,Game.viewportShiftRight,c);a=0;n=0;o=Game.viewportWidth;r=Game.viewportHeight;Game.viewportShiftRight=false}Game.ctx.save();Game.ctx.beginPath();Game.ctx.rect(n,a,o,r);Game.ctx.clip();Game.ctx.closePath();Game.ctx.fillStyle=Game.background;Game.ctx.fillRect(0,0,Game.viewportWidth,Game.viewportHeight);for(t=0;t<Game.drawLayers.length;t++){for(e=0;e<Game.drawLayers[t].length;e++){Game.drawLayers[t][e].render()}}Game.ctx.restore();Game.invalidRect=null}if(!Game.HUDOff){for(t=0;t<Game.maxHealth;t++){if(t%2==0&&t<Game.health){Game.ctx.drawImage(Game.Sprites["heart"],Math.floor(t/2)*TILESIZE+TILESIZE/2,TILESIZE/2)}else if(t==Game.health&&t%2==1){Game.ctx.drawImage(Game.Sprites["half-heart"],Math.floor(t/2)*TILESIZE+TILESIZE/2,TILESIZE/2)}else if(t%2==0){Game.ctx.drawImage(Game.Sprites["empty-heart"],Math.floor(t/2)*TILESIZE+TILESIZE/2,TILESIZE/2)}}var d=Game.currentLevel.title;if(d){Game.ctx.fillStyle=Game.background;Game.ctx.font="normal "+LEVEL_NAME_FONT_SIZE+"px Helvetica, Arial, sans-serif";Game.ctx.textAlign="right";Game.ctx.fillText(d,Game.viewportWidth-10,TILESIZE);Game.ctx.fillStyle=LEVEL_NAME_COLOR;Game.ctx.fillText(d,Game.viewportWidth-10,TILESIZE)}}},loadLevel:function(){var entities,entityString,offsetMatch,offset,signMatch,signName,linkMatch,links=[],toLevel;if(Game.currentLevel.type=="sea"){Game.background=SEA_BACKGROUND}else{Game.background=LAND_BACKGROUND}Game.hero=null;Game.currentLevel.entities=[];Game.terrainGroup=null;Game.terrainGroupType="";Game.currentLevel.entityGrid=[];for(var i=0;i<Game.currentLevel.grid.length;i++){Game.currentLevel.entityGrid[i]=[];for(var j=0;j<Game.currentLevel.grid[i].length;j++){entities=Game.currentLevel.grid[i][j].split("|");for(k=0;k<entities.length;k++){entityString=entities[k].split(":")[0];offsetMatch=entityString.match(/\[([^\[\]]*)\]/);offset=offsetMatch?offsetMatch[1]:0;linkMatch=entityString.match(/\(([^\(\)]*)\)/);linkIndex=linkMatch?linkMatch[1]:null;signMatch=entityString.match(/\{([^\{\}]*)\}/);signName=signMatch?signMatch[1]:null;entityString=entityString.replace(/\[[^\[\]]*\]/,"").replace(/\([^\(\)]*\)/,"").replace(/\{[^\{\}]*\}/,"");toLevel=entities[k].split(":")[1];if(entityString!="blank"){entity=eval("new Game.Entity."+entityString.capitalize(".")+"( "+j*TILESIZE+", "+(i*TILESIZE+offset*(TILESIZE/9))+" )");if(linkIndex){links[linkIndex]=links[linkIndex]||[];links[linkIndex].push(entity)}if(signName){if(entity.type.indexOf("Friend")===0){entity.setContent(Game.Dialog[signName])}else{entity.setContent(Game.Signs[signName])}}if(toLevel){entity.toLevel=toLevel}if(entityString=="terrain.land"||entityString=="terrain.water"){if(Game.terrainGroup&&entityString==Game.terrainGroupType){Game.terrainGroup.attach([entity])}else{Game.terrainGroup=entity;Game.terrainGroupType=entityString;Game.currentLevel.entities.push(entity)}}else{if(Game.terrainGroup||j<Game.viewportTileWidth){Game.currentLevel.entities.push(entity)}Game.terrainGroup=null}if(entityString.indexOf("hero")!=-1){Game.hero=entity}Game.currentLevel.entityGrid[i][j]=entity}else{Game.terrainGroup=null;Game.currentLevel.entityGrid[i][j]=null}}}Game.terrainGroup=null}var buttonIndex,button,linkGroup;for(var i=0,l1=links.length;i<l1;i++){linkGroup=links[i];if(linkGroup){for(var j=0,len=linkGroup.length;j<len;j++){if(linkGroup[j]&&linkGroup[j].type=="Interactable.Switch"){button=linkGroup[j];buttonIndex=j;break}}linkGroup.splice(j,1);button.setDoors(linkGroup)}}},keyDownListener:function(t){if(t.keyCode==JUMP_KEY||t.keyCode==DOWN_KEY){t.preventDefault()}if(t.keyCode==PAUSE_KEY){if(!Game.paused){Game.keysDown[PAUSE_KEY]="locked";Game.pause("pause")}}else if(t.keyCode==MAP_KEY){if(!Game.paused){Game.keysDown[MAP_KEY]="locked";Game.pause("map")}}if(Game.keysDown[t.keyCode]!="locked"){Game.keysDown[t.keyCode]=true}},keyUpListener:function(t){delete Game.keysDown[t.keyCode]},pause:function(t){if(t=="pause"){Game.pauseMenu.show()}else if(t=="map"){Game.mapMenu.show()}Game.paused=true;cancelAnimationFrame(Game.requestID)},resume:function(){Game.paused=false;Game.lastUpdate=null;Game.invalidateRect(0,Game.viewportWidth,Game.viewportHeight,0);Game.requestID=requestAnimationFrame(Game.loop)},imageLoaded:function(t){if(Game.imageCount<Game.totalSprites){Game.imageCount++;return}if(!Game.hasStarted){Game.hasStarted=true;Game.startLoop()}},stop:function(){cancelAnimationFrame(Game.requestID);Game.initDrawLayers();Game.hasStarted=false},nextGameFrame:function(){Game.requestID=requestAnimationFrame(Game.loop)},gameOver:function(){Game.gameOverMenu.show();Game.paused=true},switchLevel:function(t){Game.stopLoop=true;Game.switchToLevel=t},performLevelSwitch:function(){Game.stop();Game.init(Game.switchToLevel);Game.stopLoop=false;Game.keysLocked=false;Game.switchToLevel=null},drawRectangle:function(t,e,i,n,a,o){var r=t+i,s=e+n;i+=a;n+=a;Game.ctx.fillStyle=o;Game.ctx.fillRect(t,e,i,a);Game.ctx.fillRect(r,e,a,n);Game.ctx.fillRect(t,s,i,a);Game.ctx.fillRect(t,e,a,n)},wrapText:function(t,e,i,n,a,o,r){var s=e.split(" "),l="",h=n,c=0;for(var d=0;d<s.length;d++){var y=l+s[d]+" ";var p=t.measureText(y);var m=p.width;if(m>a&&d>0){var f=t.measureText(l).width;if(f>c)c=f;if(!r){t.fillText(l,i,n)}l=s[d]+" ";n+=o}else{l=y}}f=t.measureText(l).width;if(f>c)c=f;if(!r){t.fillText(l,i,n)}return{width:c,height:n-h,bottom:n+o*2}},currency:0,maxCurrency:9999,incrementCurrency:function(){if(this.currency<this.maxCurrency){this.currency++}},decrementCurrency:function(){if(this.currency>0){this.currency--}},maxHealth:INIT_MAX_HEALTH,health:INIT_MAX_HEALTH,incrementHealth:function(){if(this.health<this.maxHealth){this.health++}},decrementHealth:function(){if(this.health>0){this.health--}},godMode:GOD_MODE};Game.viewportTileWidth=Settings.defaultViewportWidth;Game.viewportTileHeight=Settings.defaultViewportHeight;window.Game=Game}(Settings,window,document);!function(){var t=false,e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(i){var n=this.prototype;t=true;var a=new this;t=false;for(var o in i){a[o]=typeof i[o]=="function"&&typeof n[o]=="function"&&e.test(i[o])?function(t,e){return function(){var i=this._super;this._super=n[t];var a=e.apply(this,arguments);this._super=i;return a}}(o,i[o]):i[o]}function r(){if(!t&&this.init)this.init.apply(this,arguments)}r.prototype=a;r.prototype.constructor=r;r.extend=arguments.callee;return r}}();!function(t,e,i){String.prototype.capitalize=function(t){var e,i;if(!t){return this.charAt(0).toUpperCase()+this.slice(1)}e=this.split(t);for(i in e){e[i]=e[i].capitalize()}return e.join(t)};var n=0;var a=["ms","moz","webkit","o"];for(var o=0;o<a.length&&!t.requestAnimationFrame;++o){t.requestAnimationFrame=t[a[o]+"RequestAnimationFrame"];t.cancelAnimationFrame=t[a[o]+"CancelAnimationFrame"]||t[a[o]+"CancelRequestAnimationFrame"]}if(!t.requestAnimationFrame)t.requestAnimationFrame=function(e,i){var a=(new Date).getTime();var o=Math.max(0,16-(a-n));var r=t.setTimeout(function(){e(a+o)},o);n=a+o;return r};if(!t.cancelAnimationFrame)t.cancelAnimationFrame=function(t){clearTimeout(t)}}(window,document);!function(t,e,i,n,a){t.Vector=Class.extend({init:function(t,e){this.x=t;this.y=e},add:function(e){var e=new t.Vector(this.x+e.x,this.y+e.y);return e},subtract:function(e){var e=new t.Vector(this.x-e.x,this.y-e.y);return e},multiply:function(e){var i=new t.Vector(this.x*e,this.y*e);return i},length:function(){var t=Math.pow(this.x,2)+Math.pow(this.y,2);return Math.sqrt(t)},duplicate:function(){var e=new t.Vector(this.x,this.y);return e}});t.isOnSegment=function(t,e,i,n,a,o){return(t<=a||i<=a)&&(a<=t||a<=i)&&(e<=o||n<=o)&&(o<=e||o<=n)};t.computeDirection=function(t,e,i,n,a,o){var r=(a-t)*(n-e),s=(i-t)*(o-e);return r<s?-1:r>s?1:0};t.checkIntersection=function(e,i,n,a){var o=e.x,r=e.y,s=i.x,l=i.y,h=n.x,c=n.y,d=a.x,y=a.y,p=t.computeDirection(h,c,d,y,o,r),m=t.computeDirection(h,c,d,y,s,l),f=t.computeDirection(o,r,s,l,h,c),u=t.computeDirection(o,r,s,l,d,y);return(p>0&&m<0||p<0&&m>0)&&(f>0&&u<0||f<0&&u>0)||p==0&&t.isOnSegment(h,c,d,y,o,r)||m==0&&t.isOnSegment(h,c,d,y,s,l)||f==0&&t.isOnSegment(o,r,s,l,h,c)||u==0&&t.isOnSegment(o,r,s,l,d,y)}}(Game,Settings,window,document);!function(t,e,i,n,a){var o=e.transparentColor,r=e.heroColor,s=e.enemyColor,l=e.waterColor,h=e.friendColor,c=e.rockColor,d=e.heartColor,y=e.cloudColor,p=e.blackColor,m=e.landColor,f=e.coinColor,u=e.kidColor,g=e.machineColor,v=e.woodColor;t.Sprite=function(e){var i=new Image;i.onload=function(){if(!t.Editing){t.imageLoaded()}};i.src=e;return i};t.Sprites={};t.Bitmaps={transparent:[[o]],turret:[[o,o,s,s,s,s,o,o,o],[o,o,o,s,s,s,o,o,o],[o,o,o,s,s,s,o,o,o],[o,o,s,s,s,s,s,o,o],[o,s,s,s,s,s,s,s,o],[o,s,s,s,s,s,s,s,o],[o,s,s,s,s,s,s,s,o],[o,s,s,s,s,s,s,s,o],[o,s,s,s,s,s,s,s,o]],"monster-open":[[o,s,o,o,o,o,o,s,o],[o,s,s,o,o,o,s,s,o],[o,s,p,s,s,s,p,s,o],[o,s,s,s,s,s,s,s,o],[s,s,p,s,p,s,p,s,s],[s,s,p,p,p,p,p,s,s],[o,s,p,p,p,p,p,s,o],[o,o,s,s,s,s,s,o,o],[o,s,s,s,o,s,s,s,o]],"monster-closing":[[o,s,o,o,o,o,o,s,o],[o,s,s,o,o,o,s,s,o],[o,s,p,s,s,s,p,s,o],[o,s,s,s,s,s,s,s,o],[s,s,p,s,p,s,p,s,s],[s,s,p,p,p,p,p,s,s],[o,s,s,s,s,s,s,s,o],[o,o,s,s,o,s,s,o,o],[o,s,s,s,o,s,s,s,o]],"monster-Bashed":[[o,s,o,o,o,o,o,s,o],[o,s,s,o,o,o,s,s,o],[o,s,p,s,s,s,p,s,o],[o,s,s,s,s,s,s,s,o],[s,s,s,s,s,s,s,s,s],[s,s,p,s,p,s,p,s,s],[o,s,s,s,s,s,s,s,o],[o,o,s,s,o,s,s,o,o],[o,s,s,s,o,s,s,s,o]],"monster-closed":[[o,s,o,o,o,o,o,s,o],[o,s,s,o,o,o,s,s,o],[o,s,p,s,s,s,p,s,o],[o,s,s,s,s,s,s,s,o],[s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s],[o,s,s,s,s,s,s,s,o],[o,o,s,s,o,s,s,o,o],[o,s,s,s,o,s,s,s,o]],"bird-wings-up":[[o,s,s,o,o,o,s,s,o],[o,o,s,s,o,s,s,o,o],[o,o,s,s,o,s,s,o,o],[o,o,o,s,s,s,s,o,s],[o,o,o,s,s,s,o,o,s],[o,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o]],"bird-wings-down":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,s],[o,o,o,o,o,o,o,o,s],[o,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,o],[o,o,s,s,o,s,s,o,o],[o,o,s,s,o,s,s,o,o],[o,o,o,s,o,o,s,o,o]],heart:[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,d,d,o,d,d,o,o],[o,o,d,d,d,d,d,o,o],[o,o,d,d,d,d,d,o,o],[o,o,o,d,d,d,o,o,o],[o,o,o,o,d,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o]],"half-heart":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,d,d,o,y,y,o,o],[o,o,d,d,d,y,y,o,o],[o,o,d,d,d,y,y,o,o],[o,o,o,d,d,y,o,o,o],[o,o,o,o,d,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o]],"empty-heart":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,y,y,o,y,y,o,o],[o,o,y,y,y,y,y,o,o],[o,o,y,y,y,y,y,o,o],[o,o,o,y,y,y,o,o,o],[o,o,o,o,y,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o]],"man-right":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,r,o,o,o,o],[o,o,o,o,o,o,o,r,o],[o,r,r,r,r,r,r,r,o],[o,r,o,r,r,r,o,o,o],[o,o,o,r,r,r,o,o,o],[r,r,r,o,o,o,r,o,o],[r,r,o,o,o,o,r,r,o],[r,o,o,o,o,o,r,r,r]],"man-left":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,r,o,o,o,o],[o,r,o,o,o,o,o,o,o],[o,r,r,r,r,r,r,r,o],[o,o,o,r,r,r,o,r,o],[o,o,o,r,r,r,o,o,o],[o,o,r,o,o,o,r,r,r],[o,r,r,o,o,o,o,r,r],[r,r,r,o,o,o,o,o,r]],"man-holding-right":[[o,o,r,o,o,o,r,o,o],[o,o,r,o,r,o,r,o,o],[o,o,r,o,o,o,r,o,o],[o,o,o,r,r,r,o,o,o],[o,o,o,r,r,r,o,o,o],[o,o,o,r,r,r,o,o,o],[r,r,r,o,o,o,r,o,o],[r,r,o,o,o,o,r,r,o],[r,o,o,o,o,o,r,r,r]],"man-holding-left":[[o,o,r,o,o,o,r,o,o],[o,o,r,o,r,o,r,o,o],[o,o,r,o,o,o,r,o,o],[o,o,o,r,r,r,o,o,o],[o,o,o,r,r,r,o,o,o],[o,o,o,r,r,r,o,o,o],[o,o,r,o,o,o,r,r,r],[o,r,r,o,o,o,o,r,r],[r,r,r,o,o,o,o,o,r]],rock:[[o,o,o,c,c,c,o,o,o],[o,o,c,c,c,c,c,o,o],[o,o,c,c,c,c,c,c,o],[o,c,c,c,c,c,c,c,c],[c,c,c,c,c,c,c,c,c],[c,c,c,c,c,c,c,c,c],[c,c,c,c,c,c,c,c,c],[c,c,c,c,c,c,c,c,c],[c,c,c,c,c,c,c,c,c]],coin:[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,f,f,f,o,o,o],[o,o,f,y,y,f,f,o,o],[o,o,f,f,f,y,f,o,o],[o,o,f,f,f,y,f,o,o],[o,o,o,f,f,f,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o]],"bullet-red":[[s,s],[s,s]],"bullet-green":[[r,r],[r,r]],egg:[[o,s,o],[s,s,s],[s,s,s],[o,s,o]],land:[[m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m]],"land-dying-1":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,m],[o,o,o,o,o,o,o,o,m],[o,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,o],[o,o,m,m,o,m,m,o,o],[o,o,m,m,o,m,m,o,o],[o,o,o,m,o,o,m,o,o]],"land-dying-2":[[o,o,m,o,o,o,o,m,m],[m,o,o,m,o,o,o,o,o],[o,o,o,o,o,m,o,o,m],[o,o,m,o,o,o,m,o,o],[o,o,o,o,m,o,o,o,o],[o,m,o,m,o,o,o,m,o],[o,o,o,o,o,m,o,o,o],[m,o,o,o,o,o,o,o,o],[o,o,o,m,o,o,o,m,o]],"land-dying-3":[[o,o,o,o,o,o,o,o,o],[o,o,m,o,o,o,o,o,o],[m,o,o,o,m,o,o,m,o],[o,o,o,o,o,o,o,o,o],[o,o,m,o,m,o,m,o,o],[o,m,o,o,o,o,o,m,o],[o,o,o,m,o,o,o,o,o],[o,m,o,o,m,o,o,o,m],[o,o,m,o,o,o,m,m,o]],"land-dying-4":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,m,o,o,o,o,m,o],[o,o,o,m,o,o,o,o,o],[o,m,o,o,o,o,o,o,o],[o,o,o,o,m,o,m,o,o],[o,m,o,o,o,o,m,o,o],[o,o,o,m,o,o,o,o,m],[m,m,o,o,o,o,m,o,o]],"land-dying-5":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,m,o,o,m,o,o,o],[o,o,o,o,o,o,o,m,o],[o,o,m,o,o,m,o,o,o],[o,m,o,o,o,o,o,m,o],[o,m,o,o,m,o,m,o,o]],"land-dying-6":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[m,o,o,o,o,o,o,o,o],[o,o,m,o,o,o,m,o,o],[o,o,m,o,m,o,o,o,m],[o,m,o,o,o,m,o,m,o]],"land-dying-7":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,m,o,o,m,o,o,m,o],[o,m,o,o,o,m,o,o,m],[m,o,m,o,m,o,m,o,o]],"land-dying-8":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,m,o,o,o,m,o],[m,m,m,o,m,o,m,m,m]],"land-dying-9":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[m,m,m,m,m,m,m,m,m]],"enemy-dying-1":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,s],[o,o,o,o,o,o,o,o,s],[o,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,o],[o,o,s,s,o,s,s,o,o],[o,o,s,s,o,s,s,o,o],[o,o,o,s,o,o,s,o,o]],"enemy-dying-2":[[o,o,s,o,o,o,o,s,s],[s,o,o,s,o,o,o,o,o],[o,o,o,o,o,s,o,o,s],[o,o,s,o,o,o,s,o,o],[o,o,o,o,s,o,o,o,o],[o,s,o,s,o,o,o,s,o],[o,o,o,o,o,s,o,o,o],[s,o,o,o,o,o,o,o,o],[o,o,o,s,o,o,o,s,o]],"enemy-dying-3":[[o,o,o,o,o,o,o,o,o],[o,o,s,o,o,o,o,o,o],[s,o,o,o,s,o,o,s,o],[o,o,o,o,o,o,o,o,o],[o,o,s,o,s,o,s,o,o],[o,s,o,o,o,o,o,s,o],[o,o,o,s,o,o,o,o,o],[o,s,o,o,s,o,o,o,s],[o,o,s,o,o,o,s,s,o]],"enemy-dying-4":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,s,o,o,o,o,s,o],[o,o,o,s,o,o,o,o,o],[o,s,o,o,o,o,o,o,o],[o,o,o,o,s,o,s,o,o],[o,s,o,o,o,o,s,o,o],[o,o,o,s,o,o,o,o,s],[s,s,o,o,o,o,s,o,o]],"enemy-dying-5":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,s,o,o,s,o,o,o],[o,o,o,o,o,o,o,s,o],[o,o,s,o,o,s,o,o,o],[o,s,o,o,o,o,o,s,o],[o,s,o,o,s,o,s,o,o]],"enemy-dying-6":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[s,o,o,o,o,o,o,o,o],[o,o,s,o,o,o,s,o,o],[o,o,s,o,s,o,o,o,s],[o,s,o,o,o,s,o,s,o]],"enemy-dying-7":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,s,o,o,s,o,o,s,o],[o,s,o,o,o,s,o,o,s],[s,o,s,o,s,o,s,o,o]],"enemy-dying-8":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,s,o,o,o,s,o],[s,s,s,o,s,o,s,s,s]],"enemy-dying-9":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[s,s,s,s,s,s,s,s,s]],water:[[l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l]],"wave-1":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,l],[o,o,o,o,o,o,o,l,l],[l,o,o,o,o,o,l,l,l]],"wave-2":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[l,o,o,o,o,o,o,o,o],[l,o,o,o,o,o,o,o,l],[l,l,o,o,o,o,o,l,l]],"wave-3":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,l,o,o,o,o,o,o,o],[l,l,o,o,o,o,o,o,o],[l,l,l,o,o,o,o,o,l]],"wave-4":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,l,o,o,o,o,o,o],[o,l,l,o,o,o,o,o,o],[l,l,l,l,o,o,o,o,o]],"wave-5":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,l,o,o,o,o,o],[o,o,l,l,o,o,o,o,o],[o,l,l,l,l,o,o,o,o]],"wave-6":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,l,o,o,o,o],[o,o,o,l,l,o,o,o,o],[o,o,l,l,l,l,o,o,o]],"wave-7":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,l,o,o,o],[o,o,o,o,l,l,o,o,o],[o,o,o,l,l,l,l,o,o]],"wave-8":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,l,o,o],[o,o,o,o,o,l,l,o,o],[o,o,o,o,l,l,l,l,o]],"wave-9":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,l,o],[o,o,o,o,o,o,l,l,o],[o,o,o,o,o,l,l,l,l]],"hero-dying-1":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,r],[o,o,o,o,o,o,o,o,r],[o,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,o],[o,o,r,r,o,r,r,o,o],[o,o,r,r,o,r,r,o,o],[o,o,o,r,o,o,r,o,o]],"hero-dying-2":[[o,o,r,o,o,o,o,r,r],[r,o,o,r,o,o,o,o,o],[o,o,o,o,o,r,o,o,r],[o,o,r,o,o,o,r,o,o],[o,o,o,o,r,o,o,o,o],[o,r,o,r,o,o,o,r,o],[o,o,o,o,o,r,o,o,o],[r,o,o,o,o,o,o,o,o],[o,o,o,r,o,o,o,r,o]],"hero-dying-3":[[o,o,o,o,o,o,o,o,o],[o,o,r,o,o,o,o,o,o],[r,o,o,o,r,o,o,r,o],[o,o,o,o,o,o,o,o,o],[o,o,r,o,r,o,r,o,o],[o,r,o,o,o,o,o,r,o],[o,o,o,r,o,o,o,o,o],[o,r,o,o,r,o,o,o,r],[o,o,r,o,o,o,r,r,o]],"hero-dying-4":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,r,o,o,o,o,r,o],[o,o,o,r,o,o,o,o,o],[o,r,o,o,o,o,o,o,o],[o,o,o,o,r,o,r,o,o],[o,r,o,o,o,o,r,o,o],[o,o,o,r,o,o,o,o,r],[r,r,o,o,o,o,r,o,o]],"hero-dying-5":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,r,o,o,r,o,o,o],[o,o,o,o,o,o,o,r,o],[o,o,r,o,o,r,o,o,o],[o,r,o,o,o,o,o,r,o],[o,r,o,o,r,o,r,o,o]],"hero-dying-6":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[r,o,o,o,o,o,o,o,o],[o,o,r,o,o,o,r,o,o],[o,o,r,o,r,o,o,o,r],[o,r,o,o,o,r,o,r,o]],"hero-dying-7":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,r,o,o,r,o,o,r,o],[o,r,o,o,o,r,o,o,r],[r,o,r,o,r,o,r,o,o]],"hero-dying-8":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,r,o,o,o,r,o],[r,r,r,o,r,o,r,r,r]],"hero-dying-9":[[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o],[r,r,r,r,r,r,r,r,r]],restart:[[o,o,o,r,r,r,r,o,o],[r,o,r,o,o,o,o,r,o],[r,o,o,o,o,o,o,o,r],[r,r,r,o,o,o,o,o,r],[o,o,o,o,o,o,o,o,r],[o,o,o,o,o,o,o,o,r],[o,r,o,o,o,o,o,o,r],[o,o,r,o,o,o,o,r,o],[o,o,o,r,r,r,r,o,o]],exit:[[r,r,r,r,r,r,r,o,o],[r,o,o,o,o,o,o,o,o],[r,o,o,o,o,o,o,r,o],[r,o,o,r,r,r,o,o,r],[r,o,o,o,o,o,o,r,o],[r,o,o,o,o,o,o,o,o],[r,o,o,o,o,o,r,o,o],[r,o,o,o,o,o,r,o,o],[r,r,r,r,r,r,r,o,o]],"switch":[[d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d]],trapdoor:[[m,o,m,m,o,m,m,o,m],[m,o,m,m,o,m,m,o,m],[m,o,m,m,o,m,m,o,m],[m,o,m,m,o,m,m,o,m],[m,o,m,m,o,m,m,o,m],[m,o,m,m,o,m,m,o,m],[m,o,m,m,o,m,m,o,m],[m,o,m,m,o,m,m,o,m],[m,o,m,m,o,m,m,o,m]]}}(Game,Settings,window,document);!function(t,e,i,n,a){var o=e.tileSize,r=e.gravity;t.Entity=Class.extend({type:"Entity",drawLayer:0,initialState:"still",states:{still:{animation:null,actions:null}},changeState:function(t){if(t!=this.state){this.state=t;this.activeMove=0;this.stateChanged=true}this.stateChanged=false},init:function(e,i){this.width=this.width||o;this.height=this.height||o;this.ignoreGravity=false;this.lastAnimated=Date.now();this.activeSprite=this.initialSprite||"transparent";this.visible=true;this.sprites=[];this.changeState(this.initialState);var a,s,l,h,c,d,y,p=o/9;if(e!==null&&i!==null){this.pos=new t.Vector(e,i)}else{this.pos=new t.Vector(0,0)}this.velocity=new t.Vector(0,0);this.gravity=new t.Vector(0,r);this.oldPos=this.pos;for(a in this.bitmaps){y=this.bitmaps[a];h=n.createElement("canvas");h.width=this.width;h.height=this.height;c=h.getContext("2d");for(s in y){for(l in y[s]){c.fillStyle=y[s][l];c.fillRect(l*p,s*p,p,p)}}d=h.toDataURL("image/png");this.sprites.push(t.Sprite(d,this.type))}t.drawLayers[this.drawLayer].push(this)},animate:function(){if(!this.states[this.state]){console.log("ERROR ANIMATING",this.state,this.type)}var t=this.states[this.state].animation,e=this.activeSprite,i=this.visible,n;if(typeof t=="string"){this.activeSprite=t}else if(t){var a=Date.now()-this.lastAnimated>t.delta;if(a){var o=this.activeSprite;this.activeAnimation=this.activeAnimation||0;this.activeAnimation++;this.activeAnimation%=t.sequence.length;if(this.stateChanged){this.activeAnimation=0}if(t.times=="infinite"||Math.floor(this.activeAnimation/t.sequence.length)<t.times){o=t.sequence[this.activeAnimation%t.sequence.length];if(o=="initial"){o=this.activeSprite}else if(o=="invisible"){o="invisible"}}if(o=="invisible"){this.visible=false}else{this.activeSprite=o;this.visible=true;n=true}this.lastAnimated=Date.now()}}return e!=this.activeSprite||!i&&n},performAction:function(){var t=this.states[this.state].actions,e;if(t){this.activeAction=this.activeAction||0;if(this.stateChanged){this.activeAction=0}e=t[this.activeAction];this.lastAction=this.lastAction||Date.now();if(Date.now()-this.lastAction>e.delta){if(e.until){if(e.until.call(this)){this.activeAction++;this.activeAction%=t.length}else{e.action.call(this);this.lastAction=Date.now()}}else{e.action.call(this);this.lastAction=Date.now()}}}},generateNextCoords:function(e){this.animated=this.animate(e);this.attached=false;this.detached=false;this.oldPos=new t.Vector(this.pos.x,this.pos.y);this.performAction();if(!this.ignoreGravity){this.applyGravity(e)}var i=this.velocity.multiply(e);this.pos=this.pos.add(i)},invalidateRect:function(e,i,n,a){e=e||0;i=i||0;n=n||0;a=a||0;var o=this.pos.x,r=this.pos.y,s=this.oldPos.x,l=this.oldPos.y,h=this.width,c=this.height,d=l<=r?l+e:r+e,y=s<=o?s+a:o+a,p=l+c>=r+c?l+c+n:r+c+n,m=s+h>=o+h?s+h+i:o+h+i;t.invalidateRect(d,m,p,y)},attach:function(t){var e=[],i;if(!this.entityList||!this.entityList.length){this.entityList=[{entity:this,relativePos:{x:0,y:0},oldDimensions:{width:this.width,height:this.height}}]}i=this.entityList;for(var n=0;n<t.length;n++){var a=t[n];if(a.entity){a=a.entity}i.push({entity:a,relativePos:{x:a.pos.x-this.pos.x,y:a.pos.y-this.pos.y},oldDimensions:{width:a.width,height:a.height}})}this.refreshDimensions();this.attached=true},detach:function(e){if(this.entityList&&this.entityList.length){var i=this.entityList,n,a,o;for(var r=i.length-1;r>=0;r--){o=i[r].relativePos;if(i[r].entity==e){e.pos=new t.Vector(this.pos.x+o.x,this.pos.y+o.y);a=i.splice(r+1,i.length-r);i.splice(r,1);break}}this.detached=true;this.refreshDimensions();if(this.entityList.length<=1){this.entityList=[]}return a}return[]},refreshDimensions:function(){var t=this.entityList,e,i,n,o,r,s,l,h,c,d,y,p;for(var m=0;m<t.length;m++){e=t[m].entity;i=t[m].relativePos;dimensions=t[m].oldDimensions;l=this.pos.y+i.y;h=this.pos.y+i.y+dimensions.height;c=this.pos.x+i.x;d=this.pos.x+i.x+dimensions.width;if(n===a||l<n){n=l}if(o===a||h>o){o=h}if(r===a||c<r){r=c}if(s===a||d>s){s=d}}for(var m=0;m<t.length;m++){e=t[m].entity;i=t[m].relativePos;y=this.pos.x+i.x;p=this.pos.y+i.y;t[m].relativePos={x:y-r,y:p-n}}this.height=o-n;this.width=s-r;this.pos.x=r;this.pos.y=n},render:function(){if(this.visible){if(this.entityList&&this.entityList.length){for(var e=0;e<this.entityList.length;e++){var i=this.entityList[e].entity,n=this.entityList[e].relativePos;t.ctx.drawImage(t.Sprites[i.activeSprite],this.pos.x+n.x-t.viewportOffset,this.pos.y+n.y)}}else{t.ctx.drawImage(t.Sprites[this.activeSprite],this.pos.x-t.viewportOffset,this.pos.y)}}},getCollisions:function(e,i){i=i||this;var n={top:Math.round(i.pos.y),bottom:Math.round(i.pos.y+i.height),left:Math.round(i.pos.x),right:Math.round(i.pos.x+i.width),oldTop:Math.round(i.oldPos.y),oldBototm:Math.round(i.oldPos.y+i.height),oldLeft:Math.round(i.oldPos.x),oldRight:Math.round(i.oldPos.x+i.width),oldCenter:{x:Math.round(i.oldPos.x+i.width/2),y:Math.round(i.oldPos.y+i.height/2)},center:{x:Math.round(i.pos.x+i.width/2),y:Math.round(i.pos.y+i.height/2)}},a={top:Math.round(e.pos.y),bottom:Math.round(e.pos.y+e.height),left:Math.round(e.pos.x),right:Math.round(e.pos.x+e.width),oldTop:Math.round(e.oldPos.y),oldBototm:Math.round(e.oldPos.y+e.height),oldLeft:Math.round(e.oldPos.x),oldRight:Math.round(e.oldPos.x+e.width),oldCenter:{x:Math.round(e.oldPos.x+e.width/2),y:Math.round(e.oldPos.y+e.height/2)},center:{x:Math.round(e.pos.x+e.width/2),y:Math.round(e.pos.y+e.height/2)}},o=n.left<a.right&&n.left>a.left||n.right<a.right&&n.right>a.left,r=n.top<a.bottom&&n.top>a.top||n.bottom<a.bottom&&n.bottom>a.top,s=n.left==a.left,l=n.right==a.right,h=s&&l,c=n.top==a.top,d=n.bottom==a.bottom,y=c&&d,p=n.oldRight<n.right,m=n.oldLeft>n.left,f=n.oldTop>n.top,u=n.oldBottom<n.bottom,g=t.checkIntersection(n.oldCenter,n.center,a.oldCenter,a.center),v=(r||y)&&n.right<a.left&&(n.left>a.oldRight||n.right>=a.oldLeft),G=(r||y)&&n.left>a.right&&(n.right<a.oldLeft||n.left<=a.oldRight),w=(o||h)&&n.bottom<a.top&&(n.top>a.oldBottom||n.bottom>=a.oldTop),S=(o||h)&&n.top>a.bottom&&(n.bottom<a.oldTop||n.top<=a.oldBottom),x={exact:h&&y,almostExact:s&&y||l&&y||c&&h||d&&h,overlapping:(r||c||d)&&(o||s||l),overlappingVertical:h&&(r||w||S),overlappingHorizontal:y&&(o||v||G)};
if(!g&&i.oldPos.x==i.pos.x&&i.oldPos.y==i.pos.y){if(a.oldTop<=a.top){g=t.checkIntersection({x:i.pos.x,y:i.pos.y},{x:i.pos.x+i.width,y:i.pos.y+i.height},a.oldCenter,a.center)}else{g=t.checkIntersection({x:i.pos.x+i.width,y:i.pos.y},{x:i.pos.x,y:i.pos.y+i.height},a.oldCenter,a.center)}if(!x.overlapping){x.overlapping=r&&o||g}}var L={},E=0;for(var k in x){if(x[k]){L.entity=e;L[k]=x[k];E++}}if(E){return L}return false},getAdjacents:function(t){var e={top:Math.round(this.oldPos.y),bottom:Math.round(this.oldPos.y+this.height),left:Math.round(this.oldPos.x),right:Math.round(this.oldPos.x+this.width)},i={top:Math.round(t.oldPos.y),bottom:Math.round(t.oldPos.y+t.height),left:Math.round(t.oldPos.x),right:Math.round(t.oldPos.x+t.width)},n=e.left<i.right&&e.left>i.left||e.right<i.right&&e.right>i.left,a=e.top<i.bottom&&e.top>i.top||e.bottom<i.bottom&&e.bottom>i.top,o=e.left==i.left,r=e.right==i.right,s=o&&r,l=e.top==i.top,h=e.bottom==i.bottom,c=l&&h,d={exact:s&&c,top:(n||o||r)&&e.top==i.bottom,bottom:(n||o||r)&&e.bottom==i.top,left:(a||l||h)&&e.left==i.right,right:(a||l||h)&&e.right==i.left};var y={},p=0;for(var m in d){if(d[m]){y.entity=t;y[m]=d[m];p++}}if(p){return y}return false},hasCollisionWith:function(e){var i=0,n;for(;i<t.currentLevel.entities.length;i++){entity=t.currentLevel.entities[i];n=this.getCollisions(entity);if(n&&entity.type==e){return n}}return false},adjacentTo:function(e,i){var n=0,a,o,r,s,l;for(;n<t.currentLevel.entities.length;n++){entity=t.currentLevel.entities[n];if(entity.type==e){a=this.getAdjacents(entity);if(i){if(a&&i in a){return a}}else if(a){return a}}}return false},adjacentToLevelEdge:function(e){switch(e){case"left":return this.pos.x<=0;case"right":return this.pos.x+this.width>=t.currentLevel.width;case"top":return this.pos.y<=0;break;case"bottom":return this.pos.y+this.height>=t.currentLevel.height;break;default:return false}},below:function(e){var i=t.currentLevel.entities,n,a,o;for(n=0;n<i.length;n++){o=i[n];if(o.entityList){for(a=0;a<i[n].entityList.length;a++){o=i[n].entityList[a];if(o.type==e&&o.pos.y<this.pos.y&&this.pos.x==this.pos.y){return true}}}else{if(o.type==e&&o.pos.y<this.pos.y&&this.pos.x==this.pos.y){return true}}}return false},collideWith:function(t,e){switch(t.type){case"Terrain.Trapdoor":case"Terrain.Land":if(this.velocity.y>0&&e){this.velocity.y=0;if(this.oldPos.y%o==0){this.pos.y=this.oldPos.y}else{this.pos.y=t.pos.y-this.height}}if(this.velocity.y<0&&e){this.velocity.y=0;this.pos.y=t.pos.y+this.height}break;default:break}},applyGravity:function(t){if(!this.adjacentTo("Terrain.Land","bottom")){var e=this.gravity.multiply(t);this.velocity=this.velocity.add(e)}}})}(Game,Settings,window,document);!function(t,e,i,n,a){var o=e.tileSize;var r="blank",s="terrain.land",l="terrain.water",h="terrain.wave",c="hero.man",d="hero.boat",y="hero.plane",p="enemy.monster",m="enemy.spider",f="enemy.bird",u="enemy.battleship",g="enemy.balloon",v="enemy.turret",G="interactable.coin",w="interactable.heart",S="interactable.rock",x=function(t){return"terrain.trapdoor("+t+")"},L=function(t){return"interactable.switch[6]("+t+")"};t.Level=Class.extend({init:function(t,e,i,n){var a={},r,s,l;this.entities=[];this.title=e;this.type=t;this.width=o*n[0].length;this.height=o*n.length;this.next=i;this.grid=n;for(r in this.grid){for(s in this.grid[r]){l=this.grid[r][s];if(!(l in a)){a[l]=l;this.entityCount++}}}},loadNextLevel:function(){if(this.next){t.stop();t.init(this.next)}}});t.Levels={impressionism:new t.Level("land","Impressionism","irontown",[[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,v,s],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,p,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,r,r,r,r,r,s,s],[r,r,r,r,r,r,w,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,v,s,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,s,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,s,s,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,r,r,r,r,r,r,s,s,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,p,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,s,s,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,s,s,r,r,r,r,s,r,r,r,p,s,r,r,r,r,r,r,r,p,r,r,r,p,r,r,r,v,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,r,r,r,r,r,r,r,r,r,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,p,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,S,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,v,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,v,s,s,s,s,s,s,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,p,r,r,p,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[c,r,r,G,r,r,r,r,r,s,r,r,r,r,r,r,p,r,s,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,h,h,h,h,r,r,S,r,s,r,r,r,r,r,r,r,r,v,r,r,r,r,p,r,p,r,p,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,v,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,v,r,r,r,r,s,s,s,s,s,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,l,l,l,l,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s]]),"the-cliffs-of-magnitude":new t.Level("land","The Cliffs of Magnitude","fade-to-black",[[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,f,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,s,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,s,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,s,s,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,s,s,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,f,r,r,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,s,r,r,r,r,r,r,s,r,r,r,r,r,r,r,s,s],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,s,w,r,r,r,r,s,s,r,r],[r,r,r,r,r,r,r,s,s,s,s,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,s,s,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,w,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,s,s,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r],[c,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r]]),"fade-to-black":new t.Level("land","Fade to Black",null,[[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,r,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,p,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,p,s,s,r,r,r,r,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,s,x(1),s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,s,s,s,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,S,r,r,L(2),r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,s,s,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,s,s,s,s,x(2),x(2)],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,s,s,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,s,r,r,r,r,s,r,r,r,r,s,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,s,s,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,s,s,s,s,s,r,r,r,s,r,r,r,r,r,r,r,r,r,r,r,r,p,r,r,p,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,s,s,x(3),x(3),x(3),s,s,r,r,r,r,r,r,r,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,s,s,s,s,s,s,s,s,r,r,r,r,r],[r,r,r,r,r,r,r,s,r,r,r,r,r,s,s,s,r,r,r,r,r,r,r,s,s,s,r,r,r,s,s,s,s,s,s,s,s,s,s,s,s,s,r,r,r,r,r,r,r,s,s,s,s,s,s,s,s,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,s,r,s,r,s,r,s,r,s,r,s,r,r,s,s,s,s,s,s,s,s,s,s,r,r,r,r],[c,r,S,L(3),r,r,r,s,w,r,r,r,r,p,r,s,s,s,r,r,r,r,s,s,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,p,r,p,r,r,r,s,s,s,s,s,s,s,s,s,s,s,s,r,r,L(1),r,h,h,h,h,h,r,r,v,r,s,r,s,r,s,r,s,r,s,r,s,r,r,s,s,s,s,s,s,s,s,s,s,s,r,r,r],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,l,l,l,l,l,s,s,s,s,s,r,s,r,s,r,s,r,s,r,s,r,r,s,s,s,s,s,s,s,s,s,s,s,s,s,s]])}}(Game,Settings,window,document);!function(t,e,i,n,a){var o=e.tileSize,r=e.planeTakeoffVelocity,s=e.leftKey,l=e.rightKey,h=e.downKey,c=e.upKey,d=e.actionKey,y=e.jumpKey,p=e.pauseKey,m=e.enterKey,f=e.takingDamageDuration,u=e.manJumpVelocity,g=e.blockJumpVelocity,v=e.rockThrowVelocity,G=e.boatBulletSpeed,w=e.boatBulletReloadRate,S=e.planeBulletSpeed,x=e.planeBulletReloadRate,L=e.planeHorizontalVelocity,E=e.planeLandingVelocity,r=e.planeTakeoffVelocity,f=e.takingDamageDuration,k=e.clockStopDuration,T=e.clockStopCooldown,b=e.clockJumpVelocity,I=e.flameJumpVelocity;t.Entity.Hero=t.Entity.extend({type:"Hero",drawLayer:4,states:{blinking:{animation:{delta:70,sequence:["initial","invisible"],times:"infinite"}},dying:{animation:{delta:40,sequence:["hero-dying-1","hero-dying-2","hero-dying-3","hero-dying-4","hero-dying-5","hero-dying-6","hero-dying-7","hero-dying-8","hero-dying-9"],times:1}}},init:function(t,e){this._super(t,e);this.direction="right"},right:function(){this.direction="right";if(!this.adjacentTo("Terrain.Land","right")&&!this.adjacentToLevelEdge("right")){this.pos.x+=o}},left:function(){this.direction="left";if(!this.adjacentTo("Terrain.Land","left")&&!this.adjacentToLevelEdge("left")){this.pos.x-=o}},up:function(){},down:function(){},generateNextCoords:function(e){this._super(e);if(!t.keysLocked){if(!t.keysLocked&&!this.doNotMove&&s in t.keysDown&&t.keysDown[s]!="locked"){this.left();t.keysDown[s]="locked"}if(!t.keysLocked&&!this.doNotMove&&l in t.keysDown&&t.keysDown[l]!="locked"){this.right();t.keysDown[l]="locked"}if(!t.keysLocked&&!this.doNotMove&&c in t.keysDown&&t.keysDown[c]!="locked"){this.up();t.keysDown[c]="locked"}if(!t.keysLocked&&!this.doNotMove&&y in t.keysDown&&t.keysDown[y]!="locked"){this.up();t.keysDown[y]="locked"}if(!t.keysLocked&&!this.doNotMove&&h in t.keysDown&&t.keysDown[h]!="locked"){this.down();t.keysDown[h]="locked"}if(d in t.keysDown&&t.keysDown[d]!="locked"){var i=this.adjacentTo("Terrain.Sign");if(i){if(i.entity.content){t.openSign(i.entity.content)}}i=this.adjacentTo("Friend.Kid");if(i){if(i.entity.content){t.openDialog(i.entity.content)}}i=this.adjacentTo("Friend.Man");if(i){if(i.entity.content){t.openDialog(i.entity.content)}}i=this.adjacentTo("Friend.Monster");if(i){if(i.entity.content){t.openDialog(i.entity.content)}}}}if(this.takingDamage&&this.takingDamage!="locked"){var n=this;var a=this.state;t.decrementHealth();if(t.health>0){this.changeState("blinking");this.takingDamage="locked"}else{this.changeState("dying")}setTimeout(function(){n.takingDamage=false;n.changeState(a);n.visible=true},f)}var o=this.adjacentTo("Terrain.Land");if(o.exact){this.pos.y=o.entity.pos.y-o.entity.height}if((this.activeSprite=="hero-dying-9"||this.activeSprite=="flame-dying-9")&&!t.godMode){this.visible=false;t.destroyEntity(this);t.gameOver()}if(this.pos.y>t.viewportHeight){this.visible=false;t.destroyEntity(this);t.gameOver()}},collideWith:function(e,i){var n=e.type;switch(e.type){case"Terrain.Land":if(this.velocity.y>0){this.disableJump=false}break;case"Interactable.Heart":t.destroyEntity(e);t.incrementHealth();break;case"Interactable.Coin":t.destroyEntity(e);t.incrementCurrency();break;case"Terrain.Portal":t.switchLevel(e.toLevel);break;case"Terrain.Water":if(this.type!="Hero.Boat"){t.destroyEntity(this);t.gameOver()}break;default:break}var a=n.indexOf("Enemy")==0&&!(this.type=="Hero.Block"&&this.oldPos.y<e.pos.y)||n=="Interactable.Egg"&&e.oldPos.y<this.pos.y;if(a&&e.state!="dying"&&this.takingDamage!="locked"&&!this.holding){this.takingDamage=true}this._super(e,i)}});t.Entity.Hero.Man=t.Entity.Hero.extend({type:"Hero.Man",initialSprite:"man-right",initialState:"walking",init:function(t,e){this.jumpVelocity=u;this._super(t,e)},states:{dying:t.Entity.Hero.prototype.states.dying,blinking:t.Entity.Hero.prototype.states.blinking,walking:{animation:null,actions:null}},generateNextCoords:function(e){this._super(e);if(!this.skipAction&&!t.keysLocked&&d in t.keysDown&&t.keysDown[d]!="locked"){if(this.holding){this.actions.throw.call(this);t.keysDown[d]="locked"}else{var i=this.adjacentTo("Interactable.Rock"),n=this.hasCollisionWith("Interactable.Rock");if(i){this.actions.pickup.call(this,i.entity);t.keysDown[d]="locked"}else if(n){this.actions.pickup.call(this,n.entity);t.keysDown[d]="locked"}}}if(this.velocity.y<0){this.disableJump=true}},right:function(){this._super();if(this.holding){this.activeSprite="man-holding-right"}else{this.activeSprite="man-right"}},left:function(){this._super();if(this.holding){this.activeSprite="man-holding-left"}else{this.activeSprite="man-left"}},up:function(){if(this.activeSprite.match("holding")){this.actions.drop.call(this)}else if(!this.disableJump){var e=new t.Vector(0,this.jumpVelocity);this.velocity=this.velocity.add(e)}},actions:{pickup:function(e){this.holding=e;e.pos.y=this.pos.y-e.height;e.pos.x=this.pos.x;if(this.direction=="right"){this.activeSprite="man-holding-right";this.invalidateRect(0,0+o,0,0)}else if(this.direction=="left"){this.activeSprite="man-holding-left";this.invalidateRect(0,0,0,0-o)}this.attach([e]);t.destroyEntity(e)},"throw":function(){this.detach(this.holding);t.currentLevel.entities.push(this.holding);t.drawLayers[this.holding.drawLayer].push(this.holding);if(this.direction=="right"){this.holding.velocity.x=v;this.activeSprite="man-right"}else{this.holding.velocity.x=0-v;this.activeSprite="man-left"}this.holding.velocity.y=this.jumpVelocity;this.holding=false},drop:function(){var e=this.adjacentTo("Terrain.Land","right"),i=this.adjacentTo("Terrain.Land","left");this.detach(this.holding);t.currentLevel.entities.push(this.holding);t.drawLayers[this.holding.drawLayer].push(this.holding);if(this.direction=="right"){if(!e){this.holding.pos.x=this.pos.x+this.width;this.invalidateRect(0,0+o,0,0)}else{this.holding.pos.x=this.pos.x}this.holding.pos.y=this.pos.y;this.activeSprite="man-right";this.holding=false}else{if(!i){this.holding.pos.x=this.pos.x-this.holding.width;this.invalidateRect(0,0,0,0-o)}else{this.holding.pos.x=this.pos.x}this.holding.pos.y=this.pos.y;this.activeSprite="man-left";this.holding=false}}}})}(Game,Settings,window,document);!function(t,e,i,n,a){var o=e.tileSize,r=e.turretInterval,s=e.quickTurretInterval,l=e.smartTurretInterval,h=e.turretSpeed,c=e.quickTurretSpeed,d=e.smartTurretSpeed,y=e.submarineSpeed,p=e.balloonSpeed,m=e.battleshipSpeed,f=e.birdVelocity,u=e.spiderVelocity,g=e.spiderClimbingVelocity,v=e.balloonHorizontalVelocity,G=e.balloonVerticalVelocity,w=e.balloonVerticalBoundary,S=e.monsterWalkingInterval;t.Entity.Enemy=t.Entity.extend({type:"Enemy",drawLayer:3,states:{dying:{animation:{delta:40,sequence:["enemy-dying-1","enemy-dying-2","enemy-dying-3","enemy-dying-4","enemy-dying-5","enemy-dying-6","enemy-dying-7","enemy-dying-8","enemy-dying-9"],times:1}}},generateNextCoords:function(t){this._super(t)},collideWith:function(t,e){if(t.type=="Interactable.Rock"&&(t.velocity.x>0||t.velocity.y>0)&&e||t.type=="Hero.Block"&&t.velocity.y>0&&t.oldPos.y<this.pos.y||t.type=="Hero.Clock"&&t.velocity.y>0&&t.oldPos.y<this.pos.y||t.type=="Interactable.Bullet"||t.type=="Interactable.Tongue"||t.type=="Interactable.Lightning"||t.type=="Interactable.Heat"){this.changeState("dying")}this._super(t,e)}});t.Entity.Enemy.Turret=t.Entity.Enemy.extend({type:"Enemy.Turret",bulletSpeed:h,initialSprite:"turret",rightSprite:"turret",leftSprite:"turret",initialState:"shooting",states:{dying:t.Entity.Enemy.prototype.states.dying,shooting:{animation:null,actions:[{delta:r,action:function(){this.shoot()}}]}},init:function(t,e){this._super(t,e);this.lastShot=Date.now()},generateNextCoords:function(e){this._super(e);if(this.activeSprite=="enemy-dying-9"){this.visible=false;t.destroyEntity(this)}},lockTarget:function(){var e=t.hero.pos.x,i=this.pos.x;if(e>i){this.activeSprite=this.rightSprite;this.direction="right"}else if(e<i){this.activeSprite=this.leftSprite;this.direction="left"}this.animated=true},shoot:function(){this.createBullet(this.pos.x,this.pos.y,this.bulletSpeed,0)},createBullet:function(e,i,n,a){var o=new t.Entity.Enemy.Bullet(e,i);t.currentLevel.entities.push(o);o.velocity=new t.Vector(n,a)}});t.Entity.Enemy.Monster=t.Entity.Enemy.extend({type:"Enemy.Monster",initialSprite:"monster-open",initialState:"walking",states:{dying:t.Entity.Enemy.prototype.states.dying,walking:{animation:{delta:150,sequence:["monster-open","monster-open","monster-open","monster-open","monster-open","monster-closing","monster-closed","monster-closed"],times:"infinite"},actions:[{delta:S,action:function(){this.pos.x-=o},until:function(){return this.adjacentTo("Terrain.Land","left")||this.adjacentToLevelEdge("left")}},{delta:S,action:function(){this.pos.x+=o},until:function(){return this.adjacentTo("Terrain.Land","right")||this.adjacentToLevelEdge("right")}}]}},generateNextCoords:function(e){this._super(e);if(this.activeSprite=="enemy-dying-9"){this.visible=false;t.destroyEntity(this)}}});t.Entity.Enemy.Bird=t.Entity.Enemy.extend({type:"Enemy.Bird",count:0,initialSprite:"bird-wings-up",initialState:"flying",states:{dying:t.Entity.Enemy.prototype.states.dying,flying:{animation:{delta:200,sequence:["bird-wings-up","bird-wings-down"],times:"infinite"},actions:[{delta:500,action:function(){this.dropEgg()},until:function(){return false}}]}},init:function(t,e){this._super(t,e);this.ignoreGravity=true;this.velocity.x=f},dropEgg:function(){if(Math.abs(t.hero.pos.x-this.pos.x)<o*4){var e=t.Entity.Interactable.Egg.prototype.width,i=this.pos.x+(o-e)/2,n=this.pos.y+this.height,a=this.velocity.x,r=0,s=new t.Entity.Interactable.Egg(i,n);t.currentLevel.entities.push(s);s.velocity=new t.Vector(a,r)}},generateNextCoords:function(e){if(this.state=="dying"){this.ignoreGravity=false}if(this.state=="dying"&&this.adjacentTo("Terrain.Land","bottom")){this.visible=false;t.destroyEntity(this)}this._super(e)},collideWith:function(t,e){this._super(t,e);if(t.type=="Terrain.Land"&&this.state!="dying"){this.pos.x=t.pos.x+t.width;this.velocity.x=0;this.changeState("dying")}}});t.Entity.Enemy.Bullet=t.Entity.Enemy.extend({type:"Enemy.Bullet",initialSprite:"bullet-red",drawLayer:0,width:4,height:4,states:t.Entity.prototype.states,init:function(t,e){this._super(t,e);this.ignoreGravity=true},collideWith:function(e,i){if(e.type=="Terrain.Land"||e.type=="Interactable.Lightning"){t.destroyEntity(this)}}})}(Game,Settings,window,document);!function(t,e,i,n,a){var o=e.waveSpeed,r=e.tileSize;t.Entity.Terrain=t.Entity.extend({type:"Terrain",drawLayer:1,portal:null,init:function(t,e){this._super(t,e);this.ignoreGravity=true}});t.Entity.Terrain.Land=t.Entity.Terrain.extend({type:"Terrain.Land",initialSprite:"land",states:{still:t.Entity.prototype.states.still,dying:{animation:{delta:40,sequence:["land-dying-1","land-dying-2","land-dying-3","land-dying-4","land-dying-5","land-dying-6","land-dying-7","land-dying-8","land-dying-9"],times:1}}},generateNextCoords:function(e){this._super(e);if(this.state=="dying"){this.ignoreGravity=false}if(this.state=="dying"&&this.adjacentTo("Terrain.Land","bottom")){this.visible=false;t.destroyEntity(this)}}});t.Entity.Terrain.Trapdoor=t.Entity.Terrain.Land.extend({type:"Terrain.Trapdoor",initialSprite:"trapdoor"});t.Entity.Terrain.Wave=t.Entity.Terrain.extend({type:"Terrain.Wave",drawLayer:4,initialSprite:"wave-1",initialState:"rolling",states:{rolling:{animation:{delta:o,sequence:["wave-1","wave-2","wave-3","wave-4","wave-5","wave-6","wave-7","wave-8","wave-9"],times:"infinite"}}}});t.Entity.Terrain.Water=t.Entity.Terrain.extend({type:"Terrain.Water",drawLayer:5,initialSprite:"water"});t.Entity.Terrain.Portal=t.Entity.Terrain.extend({type:"Terrain.Portal",initialState:"still"});t.Entity.Terrain.Invisible=t.Entity.Terrain.extend({type:"Terrain.Invisible",initialState:"still"})}(Game,Settings,window,document);!function(t,e,i,n,a){var o=e.tileSize;t.Entity.Interactable=t.Entity.extend({type:"Interactable",drawLayer:2,collectable:null});t.Entity.Interactable.Rock=t.Entity.Interactable.extend({type:"Interactable.Rock",initialSprite:"rock",init:function(e,i){this.velocity=new t.Vector(0,0);this._super(e,i)},collideWith:function(t,e){if(t.type=="Hero.Man"){if(this.velocity.y>0&&e){this.velocity.y=0;this.pos.y=t.pos.y-t.height;if(!t.holding){t.actions.pickup.call(t,this)}}}if(t.type=="Terrain.Land"){if(this.velocity.x>0&&this.velocity.y==0&&e){this.velocity.x=0;this.pos.x=t.pos.x-this.width}else if(this.velocity.x<0&&this.velocity.y==0&&e){this.velocity.x=0;this.pos.x=t.pos.x+this.width}}this._super(t,e)},generateNextCoords:function(e){var i;if(this.velocity.x>=0){i=new t.Vector(-3e-4,0).multiply(e)}else{i=new t.Vector(3e-4,0).multiply(e)}if(this.adjacentTo("Terrain.Land","bottom")){if(this.velocity.x!=0){this.velocity=this.velocity.add(i)}if(Math.abs(this.velocity.x)<.05){this.velocity.x=0}}this._super(e)}});t.Entity.Interactable.Coin=t.Entity.Interactable.extend({type:"Interactable.Coin",initialSprite:"coin",init:function(t,e){this._super(t,e);this.ignoreGravity=true}});t.Entity.Interactable.Heart=t.Entity.Interactable.extend({type:"Interactable.Heart",initialSprite:"heart",init:function(t,e){this._super(t,e);this.ignoreGravity=true}});t.Entity.Interactable.Bullet=t.Entity.Interactable.extend({type:"Interactable.Bullet",initialSprite:"bullet-green",drawLayer:0,width:o/9*2,height:o/9*2,init:function(t,e){this._super(t,e);this.ignoreGravity=true},collideWith:function(e,i){if(e.type=="Terrain.Land"){t.destroyEntity(this)}}});t.Entity.Interactable.Egg=t.Entity.Interactable.extend({type:"Interactable.Egg",initialSprite:"egg",width:o/9*3,height:o/9*4,drawLayer:0,collideWith:function(e,i){if(e.type=="Terrain.Land"){t.destroyEntity(this)}}});t.Entity.Interactable.Switch=t.Entity.Interactable.extend({type:"Interactable.Switch",initialSprite:"switch",width:o,height:o/9*3,init:function(t,e){this._super(t,e);this.ignoreGravity=true},setDoors:function(t){t=Object.prototype.toString.call(t)==="[object Array]"?t:[t];this.doors=t},collideWith:function(t,e){if(t.type=="Interactable.Rock"&&t.pos.y<=this.pos.y){for(var i=0,n=this.doors.length;i<n;i++){this.doors[i].changeState("dying")}}}})}(Game,Settings,window,document);